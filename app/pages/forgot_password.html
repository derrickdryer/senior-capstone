<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/public/favicon.ico" type="image/x-icon" />
    
    <meta name="description" content="Reset your password for Russell Properties. Enter your email to receive instructions for resetting your password." />
    <link rel="stylesheet" href="/public/styles/main.css" />
    
    <title>Forgot Password - Russell Properties</title>
  </head>
  <body>
    <!-- Load header and footer components -->
    <script type="module">
      import { createHeader } from "/components/header.js";
      import { createFooter } from "/components/footer.js";

      document.body.prepend(createHeader());
      document.body.appendChild(createFooter());
    </script>

    <!-- Main Content -->
    <main>
      <section id="forgot-password">
        <div class="container">
          <h2>Forgot Password</h2>
          <p>
            Please enter your email address associated with your account. We'll send you instructions to reset your password.
          </p>
          
          <!-- Forgot Password Form -->
          <form id="forgot-password-form">
            <label for="email">Email Address:</label>
            <input type="email" id="email" name="email" required />

            <button type="submit">Send Reset Link</button>
          </form>

          <p id="message"></p> <!-- Message display area -->

          <p><a href="/login">Return to Login</a></p>
        </div>
      </section>
    </main>

    <script>
      document.getElementById("forgot-password-form").addEventListener("submit", async function (event) {
        event.preventDefault(); // Prevent form from reloading page
        
        const email = document.getElementById("email").value;
        const messageElement = document.getElementById("message");

        try {
          const response = await fetch("/api/auth/forgot-password", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email: email })
          });

          if (response.ok) {
            messageElement.textContent = "✅ Reset link sent! Check your email.";
            messageElement.style.color = "green";
          } else {
            messageElement.textContent = "❌ Error sending reset link. Please try again.";
            messageElement.style.color = "red";
          }
        } catch (error) {
          console.error("Error:", error);
          messageElement.textContent = "❌ Failed to connect to the server.";
          messageElement.style.color = "red";
        }
      });
    </script>

  </body>
</html>
